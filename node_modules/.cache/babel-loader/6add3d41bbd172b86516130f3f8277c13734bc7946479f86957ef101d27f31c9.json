{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Card=_ref=>{let{movie,onDelete}=_ref;const[genreData,setGenreData]=useState([]);const[isFavorite,setIsFavorite]=useState(()=>{let storedData=window.localStorage.movies?window.localStorage.movies.split(\",\"):[];return storedData.includes(movie.id.toString());});useEffect(()=>{axios.get(\"https://api.themoviedb.org/3/genre/movie/list?api_key=ed82f4c18f2964e75117c2dc65e2161d\").then(res=>setGenreData(res.data.genres)).catch(error=>console.error(\"Error fetching genre data:\",error));},[]);const getGenreNameById=id=>{const genre=genreData.find(genre=>genre.id===id);return genre?genre.name:\"Unknown\";};const dateFormater=date=>{let newDate=new Date(date).toLocaleDateString(\"fr-FR\",{year:\"numeric\",month:\"long\",day:\"numeric\"});return newDate;};const formattedDate=dateFormater(movie.release_date);const addStorage=()=>{let storedData=window.localStorage.movies?window.localStorage.movies.split(\",\"):[];if(!storedData.includes(movie.id.toString())){storedData.push(movie.id);window.localStorage.movies=storedData;setIsFavorite(true);}};const deleteStorage=()=>{let storedData=window.localStorage.movies?window.localStorage.movies.split(\",\"):[];if(storedData.includes(movie.id.toString())){storedData=storedData.filter(id=>id!==movie.id.toString());window.localStorage.movies=storedData.join(\",\");setIsFavorite(false);// Update the state to reflect the change\nonDelete(movie.id);// Call onDelete function with movie id\n}};return/*#__PURE__*/_jsxs(\"li\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"img\",{src:movie.poster_path?\"https://image.tmdb.org/t/p/original/\"+movie.poster_path:\"/img/poster.jpg\",alt:\"Affiche \"+movie.title}),/*#__PURE__*/_jsx(\"h2\",{children:movie.title}),/*#__PURE__*/_jsxs(\"h5\",{children:[\"Sorti le : \",formattedDate]}),/*#__PURE__*/_jsxs(\"h4\",{children:[movie.vote_average,\"/10\"]}),/*#__PURE__*/_jsx(\"ul\",{className:\"tag\",children:movie.genre_ids?movie.genre_ids.map(id=>/*#__PURE__*/_jsx(\"li\",{children:getGenreNameById(id)},id)):movie.genres.map(genre=>/*#__PURE__*/_jsx(\"li\",{children:genre.name},genre.name))}),movie.overview?/*#__PURE__*/_jsx(\"h3\",{children:\"Synopsis\"}):\"\",/*#__PURE__*/_jsx(\"p\",{children:movie.overview}),isFavorite?/*#__PURE__*/_jsx(\"div\",{className:\"btn\",onClick:()=>{deleteStorage();},children:\"Supprimer de la liste\"}):/*#__PURE__*/_jsx(\"div\",{className:\"btn\",onClick:()=>addStorage(),children:\"Ajouter aux coups de coeur\"})]});};export default Card;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Card","_ref","movie","onDelete","genreData","setGenreData","isFavorite","setIsFavorite","storedData","window","localStorage","movies","split","includes","id","toString","get","then","res","data","genres","catch","error","console","getGenreNameById","genre","find","name","dateFormater","date","newDate","Date","toLocaleDateString","year","month","day","formattedDate","release_date","addStorage","push","deleteStorage","filter","join","className","children","src","poster_path","alt","title","vote_average","genre_ids","map","overview","onClick"],"sources":["/Users/valentinwestermeyer/Library/Mobile Documents/com~apple~CloudDocs/Dev/Formation/TP/React/movie-app/src/components/Card.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\n\nconst Card = ({ movie, onDelete }) => {\n  const [genreData, setGenreData] = useState([]);\n  const [isFavorite, setIsFavorite] = useState(() => {\n    let storedData = window.localStorage.movies\n      ? window.localStorage.movies.split(\",\")\n      : [];\n    return storedData.includes(movie.id.toString());\n  });\n\n  useEffect(() => {\n    axios\n      .get(\n        \"https://api.themoviedb.org/3/genre/movie/list?api_key=ed82f4c18f2964e75117c2dc65e2161d\"\n      )\n      .then((res) => setGenreData(res.data.genres))\n      .catch((error) => console.error(\"Error fetching genre data:\", error));\n  }, []);\n\n  const getGenreNameById = (id) => {\n    const genre = genreData.find((genre) => genre.id === id);\n    return genre ? genre.name : \"Unknown\";\n  };\n\n  const dateFormater = (date) => {\n    let newDate = new Date(date).toLocaleDateString(\"fr-FR\", {\n      year: \"numeric\",\n      month: \"long\",\n      day: \"numeric\",\n    });\n    return newDate;\n  };\n\n  const formattedDate = dateFormater(movie.release_date);\n\n  const addStorage = () => {\n    let storedData = window.localStorage.movies\n      ? window.localStorage.movies.split(\",\")\n      : [];\n\n    if (!storedData.includes(movie.id.toString())) {\n      storedData.push(movie.id);\n      window.localStorage.movies = storedData;\n      setIsFavorite(true);\n    }\n  };\n\n  const deleteStorage = () => {\n    let storedData = window.localStorage.movies\n      ? window.localStorage.movies.split(\",\")\n      : [];\n\n    if (storedData.includes(movie.id.toString())) {\n      storedData = storedData.filter((id) => id !== movie.id.toString());\n      window.localStorage.movies = storedData.join(\",\");\n      setIsFavorite(false); // Update the state to reflect the change\n      onDelete(movie.id); // Call onDelete function with movie id\n    }\n  };\n\n  return (\n    <li className=\"card\">\n      <img\n        src={\n          movie.poster_path\n            ? \"https://image.tmdb.org/t/p/original/\" + movie.poster_path\n            : \"/img/poster.jpg\"\n        }\n        alt={\"Affiche \" + movie.title}\n      />\n      <h2>{movie.title}</h2>\n      <h5>Sorti le : {formattedDate}</h5>\n      <h4>{movie.vote_average}/10</h4>\n      <ul className=\"tag\">\n        {movie.genre_ids\n          ? movie.genre_ids.map((id) => (\n              <li key={id}>{getGenreNameById(id)}</li>\n            ))\n          : movie.genres.map((genre) => <li key={genre.name}>{genre.name}</li>)}\n      </ul>\n      {movie.overview ? <h3>Synopsis</h3> : \"\"}\n      <p>{movie.overview}</p>\n      {isFavorite ? (\n        <div\n          className=\"btn\"\n          onClick={() => {\n            deleteStorage();\n          }}\n        >\n          Supprimer de la liste\n        </div>\n      ) : (\n        <div className=\"btn\" onClick={() => addStorage()}>\n          Ajouter aux coups de coeur\n        </div>\n      )}\n    </li>\n  );\n};\n\nexport default Card;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}